---
title: "women_participation"
author: "Madeline Gorchels"
date: "11/9/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = NA)
```

Here is a good resource I found for adding widgets to a Shiny app and using them: https://shiny.rstudio.com/tutorial/written-tutorial/lesson3/


```{r, include=FALSE}
#reading in packages and data 
library(tidyverse)
library(effsize)
library(kableExtra)
library(lubridate)

w_p = read_csv("women_participation_git_fix.csv")

#View(w_p) #calling the data frame 
```

```{r}
#Data Exploration
w_df = w_p %>% 
  filter(student_g_p == "w")
#View(w_df)
m_df = w_p %>% 
  filter(student_g_p == "m")
#View(m_df)

#Calculating general propotions in man presenting and woman presenting students
#male proportion of the cohort is 0.3108
prop_w = count(w_df)/(count(w_df)+count(m_df))
#prop_w
prop_m = count(m_df)/(count(w_df)+count(m_df))
#prop_m
prop_m

```

```{r}
sum_df = w_p %>% 
  group_by(student_g_p)
  #summarise(
    #count_time = count(time) 
    #count_answer = count(q_or_a)
  
```

```{r}
# exploratory time series graph of counts of participation by date


p_by_date <- w_p %>% 
  mutate(date = mdy(date)) %>% 
  select(date, student_g_p, class)

ggplot(p_by_date, aes(x = date)) +
  geom_bar(aes(fill = student_g_p)) +
  facet_wrap(~class)
  
  
```


###Contested Call

```{r}
con_df = w_p %>% 
  filter(cont_call == 1)

con_by_date <- con_df %>% 
  mutate(date = mdy(date)) %>% 
  select(date, student_g_p, class)

ggplot(con_by_date, aes(x = date)) +
  geom_bar(aes(fill = student_g_p)) +
  facet_wrap(~class)
```

```{r}
library(vcd)
mosaic(HairEyeColor, shade=TRUE, legend=TRUE) #Trying to do some visualization like this 
```

```{r}

con_tally = con_df %>% 
  select(prof_g_p, q_or_a, student_g_p) %>% 
  group_by(prof_g_p, q_or_a, student_g_p) %>% 
  tally()

mosaic(con_tally, shade=TRUE, legend=TRUE)
```

